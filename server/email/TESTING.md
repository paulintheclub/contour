# üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Email –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

## üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

### 1. **–ü—Ä–æ—Å–º–æ—Ç—Ä email –Ω–∞—Å—Ç—Ä–æ–µ–∫** üìä

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π –∏ –∏—Ö email –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```bash
npx tsx server/email/list-email-configs.ts
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
üìã Email –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
================================================================================

–í—Å–µ–≥–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π: 2

1. –ú–æ—è —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–∞–Ω–∏—è
   ID: cm2abc123def456
   Email –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è: ‚úÖ –í–∫–ª—é—á–µ–Ω–∞
   Email: bookings@mytours.com
   IMAP: imap.gmail.com:993
   üìù –¢–µ—Å—Ç: npx tsx server/email/test-organization-email.ts cm2abc123def456

2. –î—Ä—É–≥–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è
   ID: cm2xyz789ghi012
   Email –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è: ‚ùå –û—Ç–∫–ª—é—á–µ–Ω–∞
   
================================================================================

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
   ‚Ä¢ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π —Å –≤–∫–ª—é—á–µ–Ω–Ω—ã–º email: 1/2
   ‚Ä¢ –ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö: 1/2
```

---

### 2. **–¢–µ—Å—Ç —Å .env** (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏) üîß

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ `.env` —Ñ–∞–π–ª–∞:

```bash
npx tsx server/email/test-email.ts
```

**–¢—Ä–µ–±—É–µ—Ç—Å—è –≤ `.env`:**
```env
EMAIL_USER=your-email@gmail.com
EMAIL_PASSWORD=your-app-password
EMAIL_HOST=imap.gmail.com
EMAIL_PORT=993
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
üöÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ IMAP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...

üìß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
   Email: bookings@example.com
   Host: imap.gmail.com:993
   TLS: true

üì° –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...
‚úÖ IMAP –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
üì¨ –û—Ç–∫—Ä—ã—Ç —è—â–∏–∫: INBOX (42 –ø–∏—Å–µ–º)
‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ!

üì® –¢–µ—Å—Ç 2: –ß—Ç–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 3 –ø–∏—Å–µ–º...
‚úÖ –ü–æ–ª—É—á–µ–Ω–æ –ø–∏—Å–µ–º: 3

üìß –ü–∏—Å—å–º–æ 1:
   From: Booking.com <noreply@booking.com>
   Subject: –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ #123456
   Date: 2025-10-07T10:30:00.000Z
   Preview: –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –£ –≤–∞—Å –Ω–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ...

üì¨ –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö –ø–∏—Å–µ–º...
‚úÖ –ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö –ø–∏—Å–µ–º: 2

‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!
```

---

### 3. **–¢–µ—Å—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏–∑ –ë–î** (production-ready) ‚úÖ

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç email –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ):

```bash
npx tsx server/email/test-organization-email.ts <organization-id>
```

**–ü—Ä–∏–º–µ—Ä—ã:**

–ï—Å–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–µ–∑ ID - –ø–æ–∫–∞–∂–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:
```bash
npx tsx server/email/test-organization-email.ts
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:
```
‚ùå –£–∫–∞–∂–∏—Ç–µ ID –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: npx tsx server/email/test-organization-email.ts <organization-id>

üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å –≤–∫–ª—é—á–µ–Ω–Ω—ã–º email:
   ‚Ä¢ –ú–æ—è —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–∞–Ω–∏—è (cm2abc123def456)
     Email: bookings@mytours.com
```

–° –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º ID:
```bash
npx tsx server/email/test-organization-email.ts cm2abc123def456
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:
```
üöÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ email –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏...

üìå –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: –ú–æ—è —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–∞–Ω–∏—è
üìß Email: bookings@mytours.com
üîå Email –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è: ‚úÖ –í–∫–ª—é—á–µ–Ω–∞

üîê –ü–æ–ª—É—á–µ–Ω–∏–µ email –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ –ë–î...
‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∞
   Host: imap.gmail.com:993
   TLS: true

üì° –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...
‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ!

üì® –¢–µ—Å—Ç 2: –ß—Ç–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 5 –ø–∏—Å–µ–º...
‚úÖ –ü–æ–ª—É—á–µ–Ω–æ –ø–∏—Å–µ–º: 5

üìß –ü–∏—Å—å–º–æ 1:
   From: Booking.com <noreply@booking.com>
   Subject: –ù–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
   ...

üì¨ –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö –ø–∏—Å–µ–º...
‚úÖ –ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö –ø–∏—Å–µ–º: 2

‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!

üéâ Email –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏: –ú–æ—è —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–∞–Ω–∏—è
```

---

## üîß Workflow –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### **–®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é —Å email**
1. –í–æ–π—Ç–∏ –≤ Super Admin –ø–∞–Ω–µ–ª—å
2. –°–æ–∑–¥–∞—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –∏–ª–∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é
3. –í–∫–ª—é—á–∏—Ç—å "Email –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è"
4. –í–≤–µ—Å—Ç–∏ email –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ App Password
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å

### **–®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**
```bash
npx tsx server/email/list-email-configs.ts
```

### **–®–∞–≥ 3: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ**
–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É –∏–∑ –≤—ã–≤–æ–¥–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞:
```bash
npx tsx server/email/test-organization-email.ts <organization-id>
```

---

## ‚ùå –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏

### **Error: Invalid credentials**
```
‚ùå IMAP –æ—à–∏–±–∫–∞: Invalid credentials (Failure)
```

**–ü—Ä–∏—á–∏–Ω—ã:**
- ‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π App Password
- ‚ùå App Password —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω —Å –ø—Ä–æ–±–µ–ª–∞–º–∏
- ‚ùå 2FA –Ω–µ –≤–∫–ª—é—á–µ–Ω–∞ –≤ Google
- ‚ùå Email –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∞–∫–∫–∞—É–Ω—Ç–æ–º

**–†–µ—à–µ–Ω–∏–µ:**
1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π App Password: https://myaccount.google.com/apppasswords
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤** (16 —Å–∏–º–≤–æ–ª–æ–≤)
3. –û–±–Ω–æ–≤–∏—Ç–µ –≤ Super Admin –ø–∞–Ω–µ–ª–∏
4. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ —Ç–µ—Å—Ç

### **Error: No configuration found**
```
‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å email –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
```

**–ü—Ä–∏—á–∏–Ω—ã:**
- Email –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞
- –ù–µ —É–∫–∞–∑–∞–Ω email –∏–ª–∏ –ø–∞—Ä–æ–ª—å
- –ü–∞—Ä–æ–ª—å –Ω–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –≤ Super Admin
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —á–µ–∫–±–æ–∫—Å "–í–∫–ª—é—á–∏—Ç—å email –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é" –≤–∫–ª—é—á–µ–Ω
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è (Email, Password, Host, Port)
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ —Ç–µ—Å—Ç

### **Error: Connection timeout**
```
‚ùå IMAP –æ—à–∏–±–∫–∞: connect ETIMEDOUT
```

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall (—Ä–∞–∑—Ä–µ—à–∏—Ç–µ –ø–æ—Ä—Ç 993)
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ IMAP Host –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚úÖ Production (–ë–î)
- –ü–∞—Ä–æ–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ **—à–∏—Ñ—Ä—É—é—Ç—Å—è** –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **AES-256-CBC** —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- –ö–ª—é—á —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `.env` (`EMAIL_ENCRYPTION_KEY`)
- –¢–æ–ª—å–∫–æ Super Admin –≤–∏–¥–∏—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### ‚ö†Ô∏è Development (.env)
- **–ù–ò–ö–û–ì–î–ê** –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` –≤ git
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **App Password**, –Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞—Ä–æ–ª—å Gmail
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ App Password

---

## üìö –ß—Ç–æ –¥–∞–ª—å—à–µ?

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. ‚úÖ Email –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
2. ‚è≠Ô∏è –°–æ–∑–¥–∞—Ç—å –ø–∞—Ä—Å–µ—Ä—ã –¥–ª—è Booking.com, Airbnb, GetYourGuide
3. ‚è≠Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±—É–∫–∏–Ω–≥–æ–≤
4. ‚è≠Ô∏è Scheduler (cron) –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∏—Å–µ–º

---

## üÜò –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π —Å email
npx tsx server/email/list-email-configs.ts

# –¢–µ—Å—Ç —Å .env (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
npx tsx server/email/test-email.ts

# –¢–µ—Å—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏–∑ –ë–î
npx tsx server/email/test-organization-email.ts <org-id>

# –ü—Ä–æ—Å–º–æ—Ç—Ä .env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
grep EMAIL_ .env
```

